(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ce7a6e26"],{2355:function(t,a,i){"use strict";i.r(a);var n=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"cart"},[i("loading",{attrs:{active:t.isLoading},on:{"update:active":function(a){t.isLoading=a}}}),i("section",{staticClass:"container mt-5 py-3"},[i("div",{staticClass:"my-5 row justify-content-center"},[i("div",{staticClass:"col-md-8"},[i("div",{staticClass:"text-right mb-3"},[i("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:t.removeAllCartItem}},[i("i",{staticClass:"far fa-trash-alt"},[t._v(" 刪除所有品項")])])]),i("table",{staticClass:"table"},[t._m(0),t.cart.length?i("tbody",t._l(t.cart,(function(a){return i("tr",{key:a.id},[i("td",{staticClass:"align-middle"},[i("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button",disabled:t.status.loadingDeleteCart===a.product.id},on:{click:function(i){return t.removeCartItem(a.product.id)}}},[t.status.loadingDeleteCart===a.product.id?i("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):i("i",{staticClass:"far fa-trash-alt"})])]),i("td",{staticClass:"align-middle"},[t._v(" "+t._s(a.product.title)+" ")]),i("td",{staticClass:"align-middle"},[i("div",{staticClass:"input-group"},[i("div",{staticClass:"input-group-prepend"},[i("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",disabled:1===a.quantity},on:{click:function(i){a.quantity--,t.updateQuantity(a.product.id,a.quantity)}}},[t.status.loadingUpdateCart===a.product.id?i("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):i("span",[t._v("-")])])]),i("input",{directives:[{name:"model",rawName:"v-model",value:a.quantity,expression:"item.quantity"}],staticClass:"form-control text-center",attrs:{id:"inlineFormInputGroupUsername",type:"number",min:"1"},domProps:{value:a.quantity},on:{change:function(i){return t.updateQuantity(a.product.id,a.quantity)},input:function(i){i.target.composing||t.$set(a,"quantity",i.target.value)}}}),i("div",{staticClass:"input-group-append"},[i("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",disabled:t.status.loadingUpdateCart===a.product.id},on:{click:function(i){a.quantity++,t.updateQuantity(a.product.id,a.quantity)}}},[t.status.loadingUpdateCart===a.product.id?i("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):i("span",[t._v("+")])])])])]),i("td",{staticClass:"align-middle"},[t._v(" "+t._s(a.product.unit)+" ")]),i("td",{staticClass:"align-middle text-right"},[t._v(" "+t._s(t._f("thousands")(a.product.price))+" ")])])})),0):t._e(),i("tfoot",[i("tr",[i("td",{staticClass:"text-right",attrs:{colspan:"4"}},[t._v(" 總計 ")]),i("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("thousands")(t.cartTotal))+" ")])])])]),i("router-link",{attrs:{to:"/checkout"}},[i("button",{staticClass:"btn btn-primary w-100",attrs:{type:"button"}},[t._v("訂單結帳")])])],1)])])],1)},s=[function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("thead",[i("th",[t._v("刪除")]),i("th",[t._v("品名")]),i("th",{attrs:{width:"200px"}},[t._v(" 數量 ")]),i("th",[t._v("單位")]),i("th",[t._v("單價")])])}],e=(i("99af"),i("4160"),i("159b"),{name:"cart",data:function(){return{cart:[],cartTotal:0,isLoading:!1,fullPage:!0,status:{loadingUpdateCart:"",loadingDeleteCart:""}}},methods:{getCart:function(){var t=this;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/","api/").concat("8a9d1554-1794-46f4-9f77-1517fa6cb261","/ec/shopping");this.$http.get(a).then((function(a){t.cart=a.data.data,t.updateTotal(),t.isLoading=!1})).catch((function(){t.$bus.$emit("message:push","購物車列表載入失敗","danger"),t.isLoading=!1}))},updateTotal:function(){var t=this;this.cartTotal=0,this.cart.forEach((function(a){t.cartTotal+=a.product.price*a.quantity}))},updateQuantity:function(t,a){var i=this;this.status.loadingUpdateCart=t;var n="".concat("https://course-ec-api.hexschool.io/","api/").concat("8a9d1554-1794-46f4-9f77-1517fa6cb261","/ec/shopping"),s={product:t,quantity:a};this.$http.patch(n,s).then((function(){i.status.loadingUpdateCart="",i.getCart()})).catch((function(){i.$bus.$emit("message:push","產品數量更新失敗","danger"),i.status.loadingUpdateCart=""}))},removeAllCartItem:function(){var t=this;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/","api/").concat("8a9d1554-1794-46f4-9f77-1517fa6cb261","/ec/shopping/all/product");this.$http.delete(a).then((function(){t.getCart(),t.isLoading=!1}))},removeCartItem:function(t){var a=this;this.status.loadingDeleteCart=t;var i="".concat("https://course-ec-api.hexschool.io/","api/").concat("8a9d1554-1794-46f4-9f77-1517fa6cb261","/ec/shopping/").concat(t);this.$http.delete(i,t).then((function(){a.status.loadingDeleteCart=t,a.getCart()}))}},created:function(){this.getCart()}}),r=e,o=i("2877"),c=Object(o["a"])(r,n,s,!1,null,null,null);a["default"]=c.exports},"99af":function(t,a,i){"use strict";var n=i("23e7"),s=i("d039"),e=i("e8b5"),r=i("861d"),o=i("7b0b"),c=i("50c4"),d=i("8418"),u=i("65f0"),l=i("1dde"),p=i("b622"),h=i("2d00"),f=p("isConcatSpreadable"),g=9007199254740991,b="Maximum allowed index exceeded",v=h>=51||!s((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),C=l("concat"),m=function(t){if(!r(t))return!1;var a=t[f];return void 0!==a?!!a:e(t)},y=!v||!C;n({target:"Array",proto:!0,forced:y},{concat:function(t){var a,i,n,s,e,r=o(this),l=u(r,0),p=0;for(a=-1,n=arguments.length;a<n;a++)if(e=-1===a?r:arguments[a],m(e)){if(s=c(e.length),p+s>g)throw TypeError(b);for(i=0;i<s;i++,p++)i in e&&d(l,p,e[i])}else{if(p>=g)throw TypeError(b);d(l,p++,e)}return l.length=p,l}})}}]);
//# sourceMappingURL=chunk-ce7a6e26.2c970b91.js.map